---
title: "MCP"
icon: "server"
---

<Note>
  **Important:** The `user_id` custom claim in all cubby tokens (session & M2M) refers to the Cubby database user ID, not the Stytch authentication user ID.
</Note>

cubby offers robust MCP (Model Context Protocol) server capabilities, allowing integration with various AI clients like Claude Desktop and Cursor IDE. The MCP server is built directly into the cubby binary and runs as an HTTP service.

## Architecture

The cubby MCP server:
- Runs natively in Rust for optimal performance
- Uses HTTP Streamable transport (compatible with MCP Inspector)
- Starts automatically with the cubby service
- Available at `http://localhost:3030/mcp` by default (local) or `https://api.cubby.sh/mcp` (remote)
- No separate installation or process required
- Supports OAuth Bearer tokens for remote access

## Prerequisites

Ensure cubby is installed and running:

```bash
# Start cubby service
cargo run
```

Or if installed as a service:

```bash
# The MCP server starts automatically with cubby
cubby
```

## Supported MCP Clients

- [MCP Inspector](#mcp-inspector)
- [Claude Desktop](#claude-desktop)
- [Cursor IDE](#cursor-ide)

## MCP Inspector

The MCP Inspector is the recommended tool for testing and debugging the cubby MCP server.

### Testing with MCP Inspector

Once cubby is running on port 3030:

```bash
pnpx @modelcontextprotocol/inspector http://localhost:3030/mcp
```

This will open the MCP Inspector interface where you can:
- View all available tools
- Test tool calls interactively
- Inspect request/response data
- Debug MCP protocol interactions

## Claude Desktop

cubby integrates with **Claude Desktop** via the HTTP MCP transport.

### 1. Configure Claude Desktop

<Tabs>
  <Tab title="Windows">
    Open the configuration file using Notepad:

    <Tabs>
      <Tab title="PowerShell">
        ```powershell
        notepad $env:AppData\Claude\claude_desktop_config.json  
        ```
      </Tab>
      <Tab title="CMD">
        ```cmd
        notepad %APPDATA%\Claude\claude_desktop_config.json  
        ```
      </Tab>
    </Tabs>
  </Tab>
  <Tab title="macOS">
    Open the configuration file using your preferred editor:

    ```bash
    code "~/Library/Application Support/Claude/claude_desktop_config.json"  
    ```
  </Tab>
</Tabs>

### 2. Add cubby MCP Configuration

Add the following to your `claude_desktop_config.json`:

```json
{
    "mcpServers": {
        "cubby": {
            "url": "http://localhost:3030/mcp",
            "transport": "streamable-http"
        }
    }
}
```

> **Note:** Ensure cubby is running on port 3030. You can customize the port using the `-p` flag when starting cubby.

### 3. Restart Claude Desktop

After making changes to the configuration, restart Claude Desktop to apply the updates.

If the setup is successful, you'll see a **hammer icon** appear in the interface, indicating MCP tools are available.

## Cursor IDE

cubby MCP can be integrated with **Cursor IDE** to make it available across all your projects.

### Local Setup (No Authentication)

For local access to your own cubby instance:

1. **Open Cursor Settings**
   - Launch **Cursor IDE**
   - Click on the **gear icon** to open **Settings**
   - In the left sidebar, select **MCP**

2. **Add a Global MCP Server**
   - Click on **"Add New Global MCP Server"**
   - If the configuration file doesn't exist yet, click **"Create File"**
   - Add the following configuration:

```json
{
    "mcpServers": {
        "cubby": {
            "url": "http://localhost:3030/mcp"
        }
    }
}
```

3. **Restart MCP in Cursor**
   - Navigate back to the **Cursor Settings** tab
   - Click the **refresh icon** next to MCP servers

### Remote Setup (With Authentication)

To access your cubby data remotely from anywhere:

1. **Generate API Credentials**
   - Go to [cubby.sh/dashboard](https://cubby.sh/dashboard)
   - Log in with your account
   - Click **"Generate New Credentials"**
   - Save your **client_id**, **client_secret**, and **access_token** (shown once)

2. **Configure Cursor**
   - Open your Cursor MCP config at `~/.cursor/mcp.json`
   - Add the following configuration with your access token:

```json
{
    "mcpServers": {
        "cubby": {
            "url": "https://api.cubby.sh/mcp",
            "headers": {
                "Authorization": "Bearer YOUR_ACCESS_TOKEN_HERE"
            }
        }
    }
}
```

3. **Token Regeneration**
   - Access tokens expire (typically after 60 minutes)
   - When expired, use the client_credentials flow:

```bash
curl -X POST https://login.cubby.sh/v1/oauth2/token \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "grant_type=client_credentials" \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "client_secret=YOUR_CLIENT_SECRET" \
  -d "scope=read:cubby"
```

### Usage

- Open a new Composer and enable Agent mode
- Your cubby tools will be available
- For remote access, specify which device to control using the `deviceId` parameter

## Available Tools

The cubby MCP server provides the following tools:

### 1. search-content
Search through cubby recorded content (OCR text, audio transcriptions, UI elements). Find specific content that appeared on your screen or was spoken.

**Parameters:**
- `q`: Search query string
- `limit`: Maximum results (default: 10)
- `offset`: Pagination offset (default: 0)
- `content_type`: Filter by type ("ocr", "audio", "ui", "all")
- `start_time`/`end_time`: Time range filters (ISO format UTC)
- `app_name`/`window_name`: Filter by application or window
- `include_frames`: Include frame data in results
- And more...

```json
{
    "mcpServers": {
        "cubby": {
            "url": "http://your-server-ip:3030/mcp",
            "transport": "streamable-http"
        }
    }
}
```

> **Security Note:** Ensure proper network security when exposing cubby remotely.

## Mintlify MCP (use our docs in Cursor, Claude, etc.)

Access cubby documentation directly in your AI assistant:

```shellscript
npx mint-mcp add monadoid
```

## Additional Resources

For more information:
- [MCP Specification](https://modelcontextprotocol.io/)
- [cubby GitHub Repository](https://github.com/monadoid/cubby)
- [RMCP (Rust MCP Library)](https://github.com/rkrishn7/rmcp)
